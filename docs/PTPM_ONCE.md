```
cd PTPM/tools/
```
### Stage 1: PatchTeacher Semi-Supervised Learning
#### 1.Train PatchTeacher with Labeled Data
```
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_train.sh 4 \
--cfg_file cfgs/ptpm/once/second_tea.yaml

Comment Line 20 and uncomment Line 21 of the config before running the following scripts:
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_test.sh 4 \
--cfg_file cfgs/ptpm/once/second_tea.yaml --batch_size 32 \
--ckpt ../output/ptpm/once/second_tea/default/ckpt/checkpoint_epoch_320.pth

python -m pcdet.datasets.once.once_dataset --func create_once_infos_upart \
--cfg_file tools/cfgs/dataset_configs/once_dataset.yaml --split raw_small --post_fix round1 \
--result_path output/ptpm/once/second_tea/default/eval/epoch_320/raw_small/default/result.pkl
```

#### 2.Train PatchTeacher with Labeled Data and Pseudo Label Generated by itself
```
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_train.sh 4 \
--cfg_file cfgs/ptpm/once_small/patchteacher/second_small_ssl_tea.yaml \
--pretrained_model ../output/ptpm/once/second_tea/default/ckpt/checkpoint_epoch_320.pth

Comment Line 21 and uncomment Line 22 of the config before running the following scripts:
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_test.sh 4 \
--cfg_file cfgs/ptpm/once_small/patchteacher/second_small_ssl_tea.yaml --batch_size 16 \
--ckpt ../output/ptpm/once_small/patchteacher/second_small_ssl_tea/default/ckpt/checkpoint_epoch_320.pth

python -m pcdet.datasets.once.once_dataset --func create_once_infos_upart \
--cfg_file tools/cfgs/dataset_configs/once_dataset.yaml --split raw_small --post_fix round2 \
--result_path output/ptpm/once_small/patchteacher/second_small_ssl_tea/default/eval/epoch_320/raw_small/default/result.pkl
```

### Stage 2: Student Semi-Supervised Learning
#### 1.Train Student with Labeled Data
```
python -m pcdet.datasets.once.once_dataset --func create_once_infos \
--cfg_file cfgs/dataset_configs/once_dataset.yaml

CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_train.sh 4 \
--cfg_file cfgs/ptpm/once/second.yaml

Comment Line 19 and uncomment Line 20 of the config before running the following scripts:
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_test.sh 4 \
--cfg_file cfgs/ptpm/once/second.yaml --batch_size 32 \
--ckpt ../output/ptpm/once/second/default/ckpt/checkpoint_epoch_80.pth

python -m pcdet.datasets.once.once_dataset --func create_once_infos_upart \
--cfg_file tools/cfgs/dataset_configs/once_dataset.yaml --split raw_small \
--result_path output/once/second/default/eval/epoch_80/raw_small/default/result.pkl
```

#### 2.Train Student with Labeled Data and Pseudo Label Generated by itself
```
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_train.sh 4 \
--cfg_file cfgs/ptpm/once_small/pillarmix/second_small_ssl_stu_stu.yaml \
--pretrained_model ../output/ptpm/once/second/default/ckpt/checkpoint_epoch_80.pth
```

#### 3.Train Student with Labeled Data and Pseudo Label Generated by PatchTeacher
```
CUDA_VISIBLE_DEVICES=0,1,2,3 sh ./scripts/dist_train.sh 4 \
--cfg_file cfgs/ptpm/once_small/pillarmix/second_small_ssl_stu_tea.yaml \
--pretrained_model ../output/ptpm/once_small/pillarmix/second_small_ssl_stu_stu/default/ckpt/checkpoint_epoch_160.pth
```
